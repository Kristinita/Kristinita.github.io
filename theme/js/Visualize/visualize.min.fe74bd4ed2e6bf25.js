'use strict';(function($$$$){$$$$.fn.visualize=function($options$$){var $type$$=$options$$.type||"pie";this.each(function($index$jscomp$73_width$$,$div$$){var $chart$$;$index$jscomp$73_width$$=$options$$.width||300;var $height$$=$options$$.height||$options$$.width||300,$canvas$$=$$$$("<canvas width="+$index$jscomp$73_width$$+" height="+$height$$+"></canvas>").html($div$$.innerHTML),$items$$=$getData$$($div$$);"pie"===$type$$?$chart$$=new $Pie$$($items$$,$index$jscomp$73_width$$):"bar"===$type$$&&
($chart$$=new $Bar$$($items$$,$index$jscomp$73_width$$,$height$$));$$$$($div$$).html($canvas$$);$chart$$.plot($canvas$$[0]);$options$$.legend&&$chart$$.legend($div$$,$index$jscomp$73_width$$)})};var $Chart$$=function(){};$Chart$$.prototype.legend=function($div$$,$width$$){var $legend$$=$$$$("<div></div>").css("width",$width$$);$$$$.each(this.items,function($idx_swatch$$,$item$$){$idx_swatch$$=$$$$("<span></span>").css({background:$item$$.color,width:"10px",height:"10px",display:"inline-block",margin:"0 5px"});
$legend$$.append($idx_swatch$$).append($item$$.label)});$$$$($div$$).append($legend$$)};var $Pie$$=function($items$$,$width$$){this.radius=$width$$/2;this.items=$items$$};$Pie$$.prototype=Object.create($Chart$$.prototype);$Pie$$.prototype.getTotal=function(){var $total$$=0;$$$$.each(this.items,function($index$$,$item$$){$total$$+=$item$$.data});return $total$$};$Pie$$.prototype.plot=function($canvas$jscomp$1_i$$){var $lastend$$=0,$midX$$=this.radius,$midY$$=this.radius,$ctx$$=$canvas$jscomp$1_i$$.getContext("2d"),
$total$$=this.getTotal();$ctx$$.clearRect(0,0,$canvas$jscomp$1_i$$.width,$canvas$jscomp$1_i$$.height);for($canvas$jscomp$1_i$$=0;$canvas$jscomp$1_i$$<this.items.length;$canvas$jscomp$1_i$$++){var $item$$=this.items[$canvas$jscomp$1_i$$];$ctx$$.fillStyle=$item$$.color;$ctx$$.beginPath();$ctx$$.moveTo($midX$$,$midY$$);$ctx$$.arc($midX$$,$midY$$,$midY$$,$lastend$$,$lastend$$+$item$$.data/$total$$*Math.PI*2,!1);$ctx$$.lineTo($midX$$,$midY$$);$ctx$$.fill();$lastend$$+=$item$$.data/$total$$*Math.PI*2}};
var $Bar$$=function($items$$,$width$$,$height$$){this.items=$items$$;this.width=$width$$;this.height=$height$$};$Bar$$.prototype=Object.create($Chart$$.prototype);$Bar$$.prototype.getWidth=function(){return this.width/this.items.length};$Bar$$.prototype.getMax=function(){var $data$$=this.items.map(function($item$$){return $item$$.data});return Math.max.apply(Math,$data$$)};$Bar$$.prototype.plot=function($canvas$jscomp$2_i$$){var $width$$=this.getWidth(),$height$$=this.height,$max$$=this.getMax(),
$ctx$$=$canvas$jscomp$2_i$$.getContext("2d");$ctx$$.clearRect(0,0,$canvas$jscomp$2_i$$.width,$canvas$jscomp$2_i$$.height);for($canvas$jscomp$2_i$$=0;$canvas$jscomp$2_i$$<this.items.length;$canvas$jscomp$2_i$$++){var $item$$=this.items[$canvas$jscomp$2_i$$],$data$$=$item$$.data/$max$$*$height$$,$startX$$=$width$$*$canvas$jscomp$2_i$$,$startY$$=$height$$-$data$$;$ctx$$.beginPath();$ctx$$.rect($startX$$,$startY$$,$width$$-1,$data$$);$ctx$$.fillStyle=$item$$.color;$ctx$$.fill()}};var $randomColor$$=function(){for(var $letters$$=
"0123456789ABCDEF".split(""),$color$$="#",$i$$=0;6>$i$$;$i$$++)$color$$+=$letters$$[Math.round(15*Math.random())];return $color$$},$getData$$=function($dataset$$){var $items$$=[];$$$$.each($$$$($dataset$$).find(".visualize"),function($idx$$,$item$$){$items$$.push({data:$$$$($item$$).data("value"),color:$$$$($item$$).data("color")||$randomColor$$(),label:$item$$.textContent})});return $items$$}})(jQuery);
